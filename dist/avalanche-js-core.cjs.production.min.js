"use strict";var e,t=require("avalanche-js-crypto"),r=require("avalanche-js-utils"),n=require("avalanche-js-network"),s=require("avalanche-js-transaction"),a=require("avalanche-js-staking"),i=require("avalanche-js-contract"),o=require("avalanche-js-account"),c=(e=require("regenerator-runtime"))&&"object"==typeof e&&"default"in e?e.default:e,u=require("tslib");function h(e,t,r,n,s,a,i){try{var o=e[a](i),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){h(a,n,s,i,o,"next",e)}function o(e){h(a,n,s,i,o,"throw",e)}i(void 0)}))}}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m=function(){function e(e){this.messenger=e}var s=e.prototype;return s.setMessenger=function(e){this.messenger=e},s.getRpcResult=function(e){return e instanceof n.ResponseMiddleware?e.getRaw:e},s.getBalance=function(){var e=d(c.mark((function e(s){var a,i,o,u,h;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.address,o=void 0===(i=s.blockNumber)?r.DefaultBlockParams.latest:i,h=void 0===(u=s.shardID)?this.messenger.currentShard:u,e.next=3,this.messenger.send(n.RPCMethod.GetBalance,[t.getAddress(a).checksum,o],this.messenger.chainPrefix,h);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getBlockNumber=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=this.messenger.currentShard),e.next=3,this.messenger.send(n.RPCMethod.BlockNumber,[],this.messenger.chainPrefix,t);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getBlockByHash=function(){var e=d(c.mark((function e(t){var r,s,a,i,o;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blockHash,a=void 0===(s=t.returnObject)||s,o=void 0===(i=t.shardID)?this.messenger.currentShard:i,e.next=3,this.messenger.send(n.RPCMethod.GetBlockByHash,[r,a],this.messenger.chainPrefix,o);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getBlockByNumber=function(){var e=d(c.mark((function e(t){var s,a,i,o,u,h;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0===(s=t.blockNumber)?r.DefaultBlockParams.latest:s,o=void 0===(i=t.returnObject)||i,h=void 0===(u=t.shardID)?this.messenger.currentShard:u,e.next=3,this.messenger.send(n.RPCMethod.GetBlockByNumber,[a,o],this.messenger.chainPrefix,h);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getBlockTransactionCountByHash=function(){var e=d(c.mark((function e(t){var r,s,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blockHash,a=void 0===(s=t.shardID)?this.messenger.currentShard:s,e.next=3,this.messenger.send(n.RPCMethod.GetBlockTransactionCountByHash,[r],this.messenger.chainPrefix,a);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getBlockTransactionCountByNumber=function(){var e=d(c.mark((function e(t){var r,s,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blockNumber,a=void 0===(s=t.shardID)?this.messenger.currentShard:s,e.next=3,this.messenger.send(n.RPCMethod.GetBlockTransactionCountByNumber,[r],this.messenger.chainPrefix,a);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getTransactionByBlockHashAndIndex=function(){var e=d(c.mark((function e(t){var r,s,a,i;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blockHash,s=t.index,i=void 0===(a=t.shardID)?this.messenger.currentShard:a,e.next=3,this.messenger.send(n.RPCMethod.GetTransactionByBlockHashAndIndex,[r,s],this.messenger.chainPrefix,i);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getTransactionByBlockNumberAndIndex=function(){var e=d(c.mark((function e(t){var s,a,i,o,u;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0===(s=t.blockNumber)?r.DefaultBlockParams.latest:s,i=t.index,u=void 0===(o=t.shardID)?this.messenger.currentShard:o,e.next=3,this.messenger.send(n.RPCMethod.GetTransactionByBlockNumberAndIndex,[a,i],this.messenger.chainPrefix,u);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getTransactionByHash=function(){var e=d(c.mark((function e(t){var r,s,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.txnHash,a=void 0===(s=t.shardID)?this.messenger.currentShard:s,e.next=3,this.messenger.send(n.RPCMethod.GetTransactionByHash,[r],this.messenger.chainPrefix,a);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getTransactionReceipt=function(){var e=d(c.mark((function e(t){var r,s,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.txnHash,a=void 0===(s=t.shardID)?this.messenger.currentShard:s,e.next=3,this.messenger.send(n.RPCMethod.GetTransactionReceipt,[r],this.messenger.chainPrefix,a);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getCxReceiptByHash=function(){var e=d(c.mark((function e(t){var r,s;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.txnHash,s=t.shardID,e.next=3,this.messenger.send(n.RPCMethod.GetCXReceiptByHash,[r],this.messenger.chainPrefix,s);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getCode=function(){var e=d(c.mark((function e(s){var a,i,o,u,h;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.address,o=void 0===(i=s.blockNumber)?r.DefaultBlockParams.latest:i,h=void 0===(u=s.shardID)?this.messenger.currentShard:u,e.next=3,this.messenger.send(n.RPCMethod.GetCode,[t.getAddress(a).checksum,o],this.messenger.chainPrefix,h);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.net_peerCount=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=this.messenger.currentShard),e.next=3,this.messenger.send(n.RPCMethod.PeerCount,[],"net",t);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.net_version=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=this.messenger.currentShard),e.next=3,this.messenger.send(n.RPCMethod.NetVersion,[],"net",t);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getProtocolVersion=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=this.messenger.currentShard),e.next=3,this.messenger.send(n.RPCMethod.ProtocolVersion,[],this.messenger.chainPrefix,t);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getStorageAt=function(){var e=d(c.mark((function e(s){var a,i,o,u,h,d;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.address,i=s.position,u=void 0===(o=s.blockNumber)?r.DefaultBlockParams.latest:o,d=void 0===(h=s.shardID)?this.messenger.currentShard:h,e.next=3,this.messenger.send(n.RPCMethod.GetStorageAt,[t.getAddress(a).checksum,i,u],this.messenger.chainPrefix,d);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getTransactionCount=function(){var e=d(c.mark((function e(s){var a,i,o,u,h;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.address,o=void 0===(i=s.blockNumber)?r.DefaultBlockParams.latest:i,h=void 0===(u=s.shardID)?this.messenger.currentShard:u,e.next=3,this.messenger.send(n.RPCMethod.GetTransactionCount,[t.getAddress(a).checksum,o],this.messenger.chainPrefix,h);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.getShardingStructure=function(){var e=d(c.mark((function e(){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messenger.send(n.RPCMethod.GetShardingStructure,[],this.messenger.chainPrefix);case 2:return e.abrupt("return",this.getRpcResult(e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.sendTransaction=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isSigned()&&t){e.next=2;break}throw new Error("transaction is not signed or not exist");case 2:return e.next=4,this.messenger.send(n.RPCMethod.SendRawTransaction,[t.getRawTransaction()],this.messenger.chainPrefix,"string"==typeof t.txParams.shardID?Number.parseInt(t.txParams.shardID,10):t.txParams.shardID);case 4:return e.abrupt("return",this.getRpcResult(e.sent));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.sendRawTransaction=function(){var e=d(c.mark((function e(t){var r,n;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isSigned()&&t){e.next=2;break}throw new Error("transaction is not signed or not exist");case 2:return e.next=4,t.sendTransaction();case 4:if(n=(r=e.sent)[1],!r[0].isPending()){e.next=9;break}return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.createObservedTransaction=function(e){try{return e.sendTransaction().then((function(t){t[0].confirm(t[1]).then((function(t){e.emitter.resolve(t)}))})),e.emitter}catch(e){throw e}},s.sendRawStakingTransaction=function(){var e=d(c.mark((function e(t){var r,n;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isSigned()&&t){e.next=2;break}throw new Error("staking transaction is not signed or not exist");case 2:return e.next=4,t.sendTransaction();case 4:if(n=(r=e.sent)[1],!r[0].isPending()){e.next=9;break}return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.createObservedStakingTransaction=function(e){try{return e.sendTransaction().then((function(t){t[0].confirm(t[1]).then((function(t){e.emitter.resolve(t)}))})),e.emitter}catch(e){throw e}},s.estimateGas=function(){var e=d(c.mark((function e(r){var s,a,i,o;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.to,a=r.data,o=void 0===(i=r.shardID)?this.messenger.currentShard:i,e.next=3,this.messenger.send(n.RPCMethod.EstimateGas,[{to:t.getAddress(s).checksum,data:a}],this.messenger.chainPrefix,o);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.gasPrice=function(){var e=d(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=this.messenger.currentShard),e.next=3,this.messenger.send(n.RPCMethod.GasPrice,[],this.messenger.chainPrefix,t);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.call=function(){var e=d(c.mark((function e(t){var s,a,i,o,u;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.payload,i=void 0===(a=t.blockNumber)?r.DefaultBlockParams.latest:a,u=void 0===(o=t.shardID)?this.messenger.currentShard:o,e.next=3,this.messenger.send(n.RPCMethod.Call,[s,i],this.messenger.chainPrefix,u);case 3:return e.abrupt("return",this.getRpcResult(e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.newPendingTransactions=function(e){if(void 0===e&&(e=this.messenger.currentShard),this.messenger.provider instanceof n.WSProvider)return new n.NewPendingTransactions(this.messenger,e);throw new Error("HttpProvider does not support this feature")},s.newBlockHeaders=function(e){if(void 0===e&&(e=this.messenger.currentShard),this.messenger.provider instanceof n.WSProvider)return new n.NewHeaders(this.messenger,e);throw new Error("HttpProvider does not support this feature")},s.syncing=function(e){if(void 0===e&&(e=this.messenger.currentShard),this.messenger.provider instanceof n.WSProvider)return new n.Syncing(this.messenger,e);throw new Error("HttpProvider does not support this feature")},s.logs=function(e,t){if(void 0===t&&(t=this.messenger.currentShard),this.messenger.provider instanceof n.WSProvider)return new n.LogSub(e,this.messenger,t);throw new Error("HttpProvider does not support this feature")},e}();u.__decorate([r.assertObject({address:["isValidAddress",r.AssertType.required],blockNumber:["isBlockNumber",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getBalance",null),u.__decorate([r.assertObject({blockHash:["isHash",r.AssertType.required],returnObject:["isBoolean",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getBlockByHash",null),u.__decorate([r.assertObject({blockNumber:["isBlockNumber",r.AssertType.optional],returnObject:["isBoolean",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getBlockByNumber",null),u.__decorate([r.assertObject({blockHash:["isHash",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getBlockTransactionCountByHash",null),u.__decorate([r.assertObject({blockNumber:["isBlockNumber",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getBlockTransactionCountByNumber",null),u.__decorate([r.assertObject({blockHash:["isHash",r.AssertType.required],index:["isHex",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getTransactionByBlockHashAndIndex",null),u.__decorate([r.assertObject({blockNumber:["isBlockNumber",r.AssertType.optional],index:["isHex",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getTransactionByBlockNumberAndIndex",null),u.__decorate([r.assertObject({txnHash:["isHash",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getTransactionByHash",null),u.__decorate([r.assertObject({txnHash:["isString",r.AssertType.required],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getTransactionReceipt",null),u.__decorate([r.assertObject({txnHash:["isString",r.AssertType.required],shardID:["isNumber",r.AssertType.required]})],m.prototype,"getCxReceiptByHash",null),u.__decorate([r.assertObject({address:["isValidAddress",r.AssertType.required],blockNumber:["isBlockNumber",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getCode",null),u.__decorate([r.assertObject({address:["isValidAddress",r.AssertType.required],position:["isHex",r.AssertType.required],blockNumber:["isBlockNumber",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getStorageAt",null),u.__decorate([r.assertObject({address:["isValidAddress",r.AssertType.required],blockNumber:["isBlockNumber",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"getTransactionCount",null),u.__decorate([r.assertObject({to:["isValidAddress",r.AssertType.optional],data:["isHex",r.AssertType.optional],shardID:["isNumber",r.AssertType.optional]})],m.prototype,"estimateGas",null);var v,y=function(e){function c(c,u){var h;return void 0===u&&(u={chainId:r.defaultConfig.Default.Chain_ID,chainType:r.defaultConfig.Default.Chain_Type}),(h=e.call(this,u.chainType,u.chainId)||this).Modules={HttpProvider:n.HttpProvider,WSProvider:n.WSProvider,Messenger:n.Messenger,Blockchain:m,TransactionFactory:s.TransactionFactory,StakingFactory:a.StakingFactory,Wallet:o.Wallet,Transaction:s.Transaction,StakingTransaction:a.StakingTransaction,Account:o.Account,Contract:i.Contract},h.provider=new n.Provider(u.chainUrl||c||r.defaultConfig.Default.Chain_URL).provider,h.messenger=new n.Messenger(h.provider,h.chainType,h.chainId),h.blockchain=new m(h.messenger),h.transactions=new s.TransactionFactory(h.messenger),h.stakings=new a.StakingFactory(h.messenger),h.wallet=new o.Wallet(h.messenger),h.contracts=new i.ContractFactory(h.wallet),h.crypto=t,h.utils=r,h.defaultShardID=u.shardID,void 0!==h.defaultShardID&&h.setShardID(h.defaultShardID),h}l(c,e);var u=c.prototype;return u.setProvider=function(e){this.provider=new n.Provider(e).provider,this.messenger.setProvider(this.provider),this.setMessenger(this.messenger)},u.setChainId=function(e){this.chainId=e,this.messenger.setChainId(this.chainId),this.setMessenger(this.messenger)},u.setShardID=function(e){this.defaultShardID=e,this.messenger.setDefaultShardID(this.defaultShardID),this.setMessenger(this.messenger)},u.setChainType=function(e){this.chainType=e,this.messenger.setChainType(this.chainType),this.setMessenger(this.messenger)},u.shardingStructures=function(e){for(var t,r=g(e);!(t=r()).done;){var n=t.value,s="string"==typeof n.shardID?Number.parseInt(n.shardID,10):n.shardID;this.messenger.shardProviders.set(s,{current:void 0!==n.current&&n.current,shardID:s,http:n.http,ws:n.ws})}this.setMessenger(this.messenger)},u.setMessenger=function(e){this.blockchain.setMessenger(e),this.wallet.setMessenger(e),this.transactions.setMessenger(e),this.stakings.setMessenger(e)},c}(r.AvalancheCore),b=function(e){function n(t,n,s,a){var i;return void 0===t&&(t="http://localhost:9500"),void 0===n&&(n={menmonic:void 0,index:0,addressCount:1}),void 0===s&&(s={shardID:0,chainType:r.ChainType.Avalanche,chainId:r.ChainID.HmyLocal}),void 0===a&&(a={gasLimit:"10000000",gasPrice:"20000000000"}),(i=e.call(this,t,n.menmonic,n.index,n.addressCount,s.shardID,s.chainType,s.chainId,a.gasLimit,a.gasPrice)||this).resolveResult=function(e){var t=e.getRaw||e;return delete t.req,delete t.responseType,t},i.resolveCallback=function(e,t,r){try{e&&r(e),r(null,i.resolveResult(t))}catch(e){throw e}},i}l(n,e);var s=n.prototype;return s.send=function(){var e=d(c.mark((function e(){var n,s,a,i,o,u,h,d,p=this,l=arguments;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.resolveArgs.apply(this,l),s=n.newArgs,a=n.id,i=n.params,o=n.callback,e.t0=n.newMethod,e.next="hmy_accounts"===e.t0?4:"hmy_sendTransaction"===e.t0?7:"hmy_getTransactionReceipt"===e.t0?15:"net_version"===e.t0?19:"web3_clientVersion"===e.t0?21:"hmy_getBlockByNumber"===e.t0?23:27;break;case 4:return u=this.getAccounts(),o(null,{result:u,id:a,jsonrpc:"2.0"}),e.abrupt("return",{result:u,id:a,jsonrpc:"2.0"});case 7:return h=i[0],e.next=10,this.signTransaction(h);case 10:return d=e.sent,e.next=13,this.provider.send({id:a,method:"hmy_sendRawTransaction",params:[d],jsonrpc:"2.0"},(function(e,t){return p.resolveCallback(e,t,o)}));case 13:return e.abrupt("return",this.resolveResult(e.sent));case 15:return e.next=17,this.provider.send({id:a,method:"hmy_getTransactionReceipt",params:[i[0]],jsonrpc:"2.0"},(function(e,t){try{e&&o(e);var r=p.resolveResult(t);null!==r.result&&(r.result.status="0x1"),o(null,r)}catch(e){throw e}}));case 17:return e.abrupt("return",this.resolveResult(e.sent));case 19:return o(null,{result:String(this.messenger.chainId),id:a,jsonrpc:"2.0"}),e.abrupt("return",{result:String(this.messenger.chainId),id:a,jsonrpc:"2.0"});case 21:return o(null,{result:"Avalanche/1.0.0/@avalanche-js",id:a,jsonrpc:"2.0"}),e.abrupt("return",{result:"Avalanche/1.0.0/@avalanche-js",id:a,jsonrpc:"2.0"});case 23:return e.next=25,this.provider.send(s,(function(e,n){try{e&&o(e);var s=p.resolveResult(n);if(s.error)return void o(s.error);new r.Unit(s.result.gasLimit).asWei().toWei().gt(new r.Unit(p.gasLimit).asWei().toWei())&&(s.result.gasLimit="0x"+new r.Unit(p.gasLimit).asWei().toWei().toString("hex")),r.isBech32Address(s.result.miner)&&(s.result.miner=t.fromBech32(s.result.miner,t.HRP)),o(null,s)}catch(e){throw e}}));case 25:return e.abrupt("return",this.resolveResult(e.sent));case 27:return e.next=29,this.provider.send(s,(function(e,t){return p.resolveCallback(e,t,o)}));case 29:return e.abrupt("return",this.resolveResult(e.sent));case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.sendAsync=function(){return this.send.apply(this,arguments)},s.resolveArgs=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0].method,s=t[0].params,a=n;n.startsWith("eth")&&(a=n.replace("eth","hmy")),t[0].method=a;var i=t[0].id;return{newArgs:t[0],id:i,params:s,newMethod:a,callback:t[1]}},n}(o.HDNode);(v=exports.ExtensionType||(exports.ExtensionType={})).MathWallet="MathWallet",v.AVAXWallet="AVAXWallet";var x,w=function(){function e(e,a){void 0===a&&(a={chainId:r.defaultConfig.Default.Chain_ID,chainType:r.defaultConfig.Default.Chain_Type}),this.extensionType=null,this.wallet=e,this.isExtension(this.wallet),e.messenger?(this.provider=e.messenger.provider,this.messenger=e.messenger):(this.provider=new n.Provider(a.chainUrl||e.network.chain_url).provider,this.messenger=new n.Messenger(this.provider,a.chainType,a.chainId)),this.wallet.messenger=this.messenger,this.blockchain=new m(this.messenger),this.transactions=new s.TransactionFactory(this.messenger),this.contracts=new i.ContractFactory(this.wallet),this.crypto=t,this.utils=r}var a=e.prototype;return a.setProvider=function(e){this.provider=new n.Provider(e).provider,this.messenger.setProvider(this.provider),this.setMessenger(this.messenger)},a.setShardID=function(e){this.defaultShardID=e,this.messenger.setDefaultShardID(this.defaultShardID),this.setMessenger(this.messenger)},a.isExtension=function(e){var s=this,a=!1;if(this.extensionType=null,e.isMathWallet||e.isAVAXWallet){a=!0,this.extensionType=e.isMathWallet?exports.ExtensionType.MathWallet:exports.ExtensionType.AVAXWallet;var i=this.wallet.signTransaction;this.wallet.signTransaction=function(){var e=d(c.mark((function e(a,o,u,h){var d,l;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===o&&(o=!0),void 0===u&&(u="rlp"),void 0===h&&(h="latest"),e.next=5,s.wallet.getAccount();case 5:if(d=e.sent,!o){e.next=13;break}return e.next=9,s.messenger.send(n.RPCMethod.GetAccountNonce,[t.getAddress(d.address).checksum,h],s.messenger.chainPrefix,"string"==typeof a.txParams.shardID?Number.parseInt(a.txParams.shardID,10):a.txParams.shardID);case 9:l=e.sent,a.setParams(p({},a.txParams,{from:t.getAddress(d.address).bech32,nonce:Number.parseInt(r.isHex(l.result.toString())?r.hexToNumber(l.result.toString()):l.result.toString(),10)})),e.next=14;break;case 13:a.setParams(p({},a.txParams,{from:t.getAddress(d.address).bech32}));case 14:return e.abrupt("return",i(a,!1,u,h));case 15:case"end":return e.stop()}}),e)})));return function(t,r,n,s){return e.apply(this,arguments)}}()}if(!a)throw new Error("Extension is not found")},a.login=function(){var e=d(c.mark((function e(){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wallet.getAccount();case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.logout=function(){var e=d(c.mark((function e(){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wallet.forgetIdentity();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.shardingStructures=function(e){for(var t,r=g(e);!(t=r()).done;){var n=t.value,s="string"==typeof n.shardID?Number.parseInt(n.shardID,10):n.shardID;this.messenger.shardProviders.set(s,{current:void 0!==n.current&&n.current,shardID:s,http:n.http,ws:n.ws})}this.setMessenger(this.messenger)},a.setMessenger=function(e){this.blockchain.setMessenger(e),this.wallet.messenger=e,this.transactions.setMessenger(e)},e}();(x=exports.UrlType||(exports.UrlType={}))[x.http=0]="http",x[x.ws=1]="ws",exports.Avalanche=y,exports.AvalancheExtension=w,exports.Blockchain=m,exports.TruffleProvider=b;
//# sourceMappingURL=avalanche-js-core.cjs.production.min.js.map
